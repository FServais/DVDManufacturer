\documentclass[a4paper,titlepage]{article}

%PACKAGES
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{fancyhdr}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{fancybox}
\usepackage{textcomp}
\usepackage{pdflscape}
\usepackage{svg}


%Symbole euro
\usepackage{eurosym}

%Listings : affichage code
\usepackage{listings}

\geometry{hmargin=2cm}


%Elements de la page de garde
\begin{document}


\begin{titlepage}

\begin{figure}
\centering
\includegraphics[width=5cm]{logo-ulg.png}
\end{figure}



\title{
\vspace{0.2cm}
\LARGE{\textbf{Project 2 - Firewalls}} \\ \textsc{Introduction to Computer Security}
\author{\textbf{Floriane Magera} \small{(S111295})\\\textbf{Fabrice Servais} \small{(S111093})}\\
\date{March 27, 2015}
\rule{15cm}{1.5pt}
}

\end{titlepage}

%DOCUMENT
\pagestyle{fancy}
\lhead{Project 2 : Firewalls}
\rhead{Introduction to Computer Security}

%Page de garde
\maketitle

\section{Zones}
\label{sec:Zones}

\begin{table}[h]
	\center
	\begin{tabular}{c|l}
		Zone & Elements\\
		\hline
		1 & web\\
		2 & SMTP\\
		3 & I2\\
		4 & PDNS\\
		5 & DHCP\_R2, U2\\
		6 & DHCP, SSH, HTTP, LDNS\\
		7 & RSYNC\\
		8 & DHCP\_R1, I1, U1\\
		9 & Internet\\
	\end{tabular}
	\caption{List of the zones and their components}
\end{table}


\section{Rules}
\label{sec:Rules}

% ========================== FW1 ==========================

\begin{table}[h]
	\center
	\begin{tabular}{c|c|cc|cc|ccl}
		Zone & Number & Source & Port & Dest & Port & Protocol & Action & \multicolumn{1}{c}{Comments}\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 4 : Incoming rules}}\\
		4 &  & Any & Any & 172.14.5.3 & 53 & UDP/TCP & Allow & DNS requests from anywhere\\
		4 &  & Any & Any & 172.14.5.3 & Any & Any & Deny & Not a DNS request\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 4 : Outgoing rules}}\\
		4 &  & 172.14.5.3 & Any & 208.67.222.222 & 53 & UDP/TCP & Allow & Ask prime DNS\\
		4 &  & 172.14.5.3 & Any & Any & Any & Any & Deny & Not a DNS reply\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 1 : Incoming rules}}\\
		1 &  & Any & Any & 172.14.6.3 & 80 & TCP & Allow & HTTP web server\\
		1 &  & Any & Any & 172.14.6.3 & 443 & TCP & Allow & HTTPS web server\\
		1 &  & 172.14.5.2 & Any & 172.14.6.3 & 21 & TCP & Allow & FTP\\
		1 &  & 172.14.6.2 & Any & 172.14.6.3 & 21 & TCP & Allow & FTP\\
		1 &  & Any & Any & 172.14.6.3 & Any & Any & Deny & Rejects other\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 1 : Outgoing rules}}\\
		1 & & 172.14.6.3 & 20 & Any & Any & TCP & Allow & FTP data (reply)\\
		1 & & 172.14.6.3 & Any & Any & Any & Any & Deny & Rejects other\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 9 : Incoming rules}}\\
		9 &  & 172.14.5.3 & Any & 208.67.222.222 & 53 & UDP/TCP & Allow & PDNS populate its cache (see zone 4, outgoing)\\
		9 &  & 172.14.5.2 & Any & Internet & Any & TCP & Allow & From FW2\\
		9 &  & 172.14.7.2 & Any & Internet & 25, 587, 465 & TCP & Allow & SMTP to internet\\
		9 &  & 172.14.6.2 & Any & Internet & Any & TCP & Allow & I2 (through FW3) to internet\\
		9 &  & Any & Any & Internet & Any & Any & Deny & Deny otherwise\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 9 : Outgoing rules}}\\
		9 &  & Internet & Any & 172.14.5.3 & 53 & TCP/UDP & Allow & Internet searches in PDNS\\
		9 &  & Internet & Any & 172.14.5.2 & 3003 & TCP & Allow & Internet to SSH\\
		9 &  & Internet & Any & 172.14.6.3 & 80 & TCP & Allow & Visit website\\
		9 &  & Internet & Any & 172.14.7.2 & 25, 587, 465 & TCP & Allow & Internet to SMTP\\
		9 &  & Internet & Any & Any & Any & Deny & Deny otherwise

	\end{tabular}
	\caption{Firewall 1}
\end{table}

% ========================== FW2 ==========================

At FW2 we configured the NAT table as follow :
\begin{itemize}
\item For outgoing traffic, we used MASQUERADE in order to have dynamic mappings.
\item For incoming traffic, we based ourselves on the destination port. For example, the port 22 meant that the destination had to be replaced by SSH address with DNAT. Only the servers are available.
\end{itemize}


\begin{table}[h]
	\center
	\begin{tabular}{c|c|cc|cc|ccl}
		Zone & Number & Source & Port & Dest & Port & Protocol & Action & \multicolumn{1}{c}{Comments}\\
		\hline
		\multicolumn{9}{l}{\textbf{Zone 6 : Incoming rules}}\\
		6 & 1 & 172.16.5.2 & 68 & 172.16.6.2 & 67 & UDP & Allow & DHCP \\
		6 & 2 & Any & Any & 172.16.6.3 & 22 & TCP & Allow & SSH \\
		6 & 3 & 172.16.5.0 & Any & 172.16.6.4 & 80 & TCP & Allow & HTTP \\
		6 & 4 & 172.16.5.0 & Any & 172.16.6.4 & 3128 & TCP & Allow & HTTP redirection with lynx \\
		6 & 5 & 172.16.5.0 & Any & 172.16.6.4 & 443 & TCP & Allow & HTTPS \\
		6 & 6 & 172.14.6.2 & Any & 172.16.6.4 & 80 & TCP & Allow & HTTP \\
		6 & 7 & 172.14.6.2 & Any & 172.16.6.4 & 3128 & TCP & Allow & HTTP redirection with lynx  \\
		6 & 8 & 172.14.6.2 & Any & 172.16.6.4 & 443 & TCP & Allow & HTTPS \\
		6 & 9 & 172.16.5.0 & Any & 172.16.6.5 & 53 & UDP & Allow & DNS \\
		6 & 10 & Any & Any & Any & Any & Any & Deny & \\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 6 : Outgoing rules}}\\

		6 & 1 & 172.16.6.3 & Any & Any & 22 & TCP & Allow & SSH\\
		6 & 2 & 172.16.6.4 & Any & Any & 80 & TCP & Allow & HTTP\\
		6 & 3 & 172.16.6.4 & Any & Any & 443 & TCP & Allow & HTTPS\\
		6 & 4 & 172.16.6.5 & Any & 172.14.5.3 & 53 & UDP/TCP & Allow & DNS \\
		6 & 4 & 172.16.6.5 & Any & 208.67.222.222 & 53 & UDP/TCP & Allow & prime DNS \\
		6 & 5 & 172.16.6.2 & 68 & 172.16.5.2 & 67 & UDP & Allow & DHCP \\
		6 & 6 & Any & Any & Any & Any & Any & Deny & \\
		\hline
		\multicolumn{9}{l}{\textbf{Zone 5 : Incoming rules}}\\
		5 & 1 & Any & Any & Any & Any & Any & Deny & \\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 5 : Outgoing rules}}\\
		5 & 1 & 172.16.5.2 & 68 & 172.16.6.2 & 67 & DHCP & Allow & DHCP\\
		5 & 2 & 172.16.5.3... & Any & 172.16.6.4 & 80 & TCP & Allow & HTTP \\
		5 & 3 & 172.16.5.3... & Any & 172.16.6.4 & 443 & TCP & Allow & HTTPS \\
		5 & 4 & 172.16.5.3... & Any & 172.16.6.3 & 22 & TCP & Allow & SSH \\
		5 & 5 & 172.16.5.3... & Any & 172.16.9.2 & 873 & TCP & Allow & RSYNC \\
		5 & 6 & 172.16.5.3... & Any & 172.16.6.5 & 53 & UDP/TCP & Allow & DNS (local) \\
		5 & 7 & 172.16.5.3... & Any & 172.14.6.2 & Any & Any & Allow & Link to FW2 \\
		5 & 8 & 172.16.5.3... & Any & 172.14.6.3 & 80 & TCP & Allow & HTTP web server \\
		5 & 9 & 172.16.5.3... & Any & 172.14.6.3 & 443 & TCP & Allow & HTTPS web server \\
		5 & 10 & 172.16.5.3... & Any & 172.14.6.3 & 21 & TCP & Allow & FTP web server \\
		5 & 11 & 172.16.5.3... & Any & 172.14.7.2 & Any & TCP & Allow & SMTP \\

		5 & 12 & Any & Any & Any & Any & Any & Deny & \\


	\end{tabular}
	\caption{Firewall 2}
\end{table}


% ========================== FW3 ==========================

\begin{table}[h]
	\centering
	\small
	\begin{tabular}{c|c|cc|cc|ccl}
		Zone & Number & Source & Port & Dest & Port & Protocol & Action & \multicolumn{1}{c}{Comments}\\
		\hline
		\multicolumn{9}{l}{\textbf{Zone 3 : Incoming rules}}\\
		3 &  & 172.14.5.2 & Any & 172.16.4.2 & 22 & TCP & Allow & SSH\\
		3 &  & 172.14.6.3 & 20 & 172.14.6.2 & Any & TCP & Allow & FTP (data)\\
		3 &  & Any & Any & 172.16.4.2 & Any & Any & Deny & Deny otherwise\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 3 : Outgoing rules}}\\
		3 &  & 172.16.4.2 & Any & 172.14.5.2 & 22 & TCP & Allow & SSH through FW2\\
		3 &  & 172.16.4.2 & Any & 172.14.5.2 & 80 & TCP & Allow & HTTP through FW2\\
		3 &  & 172.16.4.2 & Any & 172.14.5.2 & 443 & TCP & Allow & HTTPS through FW2\\
		3 &  & 172.16.4.2 & Any & 172.14.5.2 & 3128 & TCP & Allow & HTTP through FW2 (lynx) \\
		3 &  & 172.16.4.2 & Any & 172.14.5.3 & 53 & UDP/TCP & Allow & (P)DNS\\
		3 &  & 172.16.4.2 & Any & 172.14.6.3 & 21/80 & TCP & Allow & Web\\
		3 &  & 172.16.4.2 & Any & 172.14.7.2 & 25 & TCP & Allow & SMTP\\
		3 &  & 172.16.4.2 & Any & Any & Any & Any & Deny & Deny otherwise\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 2 : Incoming rules}}\\
		2 &  & 172.14.5.2.2 & 3261 to 3514 & 172.14.6.2 & Any & TCP & Allow & SMTP from U2\\
		2 &  & Any & Any & 172.14.6.2 & Any & Any & Deny & Deny otherwise\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 2 : Outgoing rules}}\\
		2 &  & 172.14.6.2 & Any & Any & Any & Any & Deny & Deny requests from SMTP\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 1 : Incoming rules}}\\
		1 &  & Any & Any & 172.14.6.3 & 80 & TCP & Allow & HTTP (web server)\\
		1 &  & Any & Any & 172.14.6.3 & 443 & TCP & Allow & HTTPS (web server)\\
		1 &  & Any & Any & 172.14.6.3 & 21 & TCP & Allow & FTP\\
		1 &  & Any & Any & 172.14.6.3 & Any & Any & Deny & Deny otherwise\\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 1 : Outgoing rules}}\\
		1 &  & 172.14.6.3 & 20 & Any & Any & TCP & Allow & FTP (data)\\
		1 &  & 172.14.6.3 & Any & Any & Any & Any & Deny & Deny otherwise\\
	\end{tabular}
	\caption{Firewall 3}
\end{table}




% ========================== FW4 ==========================

\begin{table}[h]
	\center
	\begin{tabular}{c|c|cc|cc|ccl}
		Zone & Number & Source & Port & Dest & Port & Protocol & Action & \multicolumn{1}{c}{Comments}\\
		\hline
		\multicolumn{9}{l}{\textbf{Zone 7 : Incoming rules}}\\
		7 & 1 & 172.16.7.3 & Any & 172.16.9.2 & 22 & TCP & Allow & SSH\\
		7 & 2 & 172.16.8.0 & Any & 172.16.9.2 & 873 & TCP & Allow & \\
		7 & 3 & Any & Any & Any & Any & Any & Deny & \\
		\hline
		\multicolumn{9}{l}{\textbf{Zone 7 : Outgoing rules}}\\
		7 & 1 & Any & Any & Any & Any & Any & Deny & \\

		\hline
		\multicolumn{9}{l}{\textbf{Zone 8 : Incoming rules}}\\
		8 & 1 & 172.16.7.2 & 68 &  172.16.8.2 & 67 & UDP & Allow & DHCP\\
		8 & 2 & 172.16.7.3 & Any & 172.16.8.0 & 22 & TCP & Allow & SSH \\
		8 & 3 & Any & Any & Any & Any & Any & Deny & \\
		\hline
		\multicolumn{9}{l}{\textbf{Zone 8 : Outgoing rules}}\\
		8 & 1 & 172.16.8.2 & 68 & 172.16.7.2 & 67 & UDP & Allow & DHCP\\
		8 & 2 & 172.16.8.3... & Any & 172.16.7.4 & 80 & TCP & Allow & HTTP \\
		8 & 3 & 172.16.8.3... & Any & 172.16.7.4 & 3128 & TCP & Allow & HTTP for lynx\\
		8 & 4 & 172.16.8.3... & Any & 172.16.7.4 & 443 & TCP & Allow & HTTPS \\
		8 & 5 & 172.16.8.3... & Any & 172.16.7.3 & 22 & TCP & Allow & SSH \\
		8 & 6 & 172.16.8.3... & Any & 172.16.9.2 & 873 & TCP & Allow & RSYNC \\
		8 & 7 & 172.16.8.3... & Any & 172.16.7.5 & 53 & UDP & Allow & DNS (local) \\
		8 & 8 & Any & Any & Any & Any & Any & Deny & \\
		\hline

	\end{tabular}
	\caption{Firewall 4}
\end{table}




\end{document}
